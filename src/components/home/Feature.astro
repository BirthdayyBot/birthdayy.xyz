---
import { ArrowRight } from "../ui/Icon.jsx";
import IconText from "../ui/IconText.astro";

interface Props {
  title: string;
  description: string;
  imageName: string;
  points: string[];
  imagePosition: 'left' | 'right';
}

const { title, description, imageName, points, imagePosition } = Astro.props;

// Determine column order based on image position
const isImageLeft = imagePosition === 'left';
const textOrder = isImageLeft ? 'order-2' : 'order-1';
const imageOrder = isImageLeft ? 'order-1 order-2-mobile' : 'order-2 order-1-mobile';
---

<div class="feature columns is-centered is-multiline">
  <!-- Text Column -->
  <div class={`column is-2 ${textOrder} feature-text`}>
    <h3 class="block is-title is-size-3 mt-5 has-text-centered-touch feature-title">
      {title}
    </h3>
    <p class="block is-sub-title feature-description">{description}</p>
    {points && points.length > 0 && (
      <div class="block is-sub-title feature-points">
        {points.map((point) => (
          <div class="feature-point">
            <IconText text={point}>
              <ArrowRight slot="icon" client:load />
            </IconText>
          </div>
        ))}
      </div>
    )}
  </div>

  <!-- Image Column -->
  <div class={`column is-3 ${imageOrder} feature-image-column`}>
    <div class="feature-image-wrapper">
      <img
        src={`/media/images/features/${imageName}.webp`}
        width="1920"
        height="1680"
        loading="lazy"
        alt={`${title} feature screenshot`}
        class="showcase_image"
      />
    </div>
  </div>
</div>

<style lang="scss">
  .feature {
    margin-bottom: 4rem;

    &:last-child {
      margin-bottom: 2rem;
    }
  }

  .feature-text {
    animation: fadeInLeft 0.8s ease-out both;
  }

  .feature-image-column {
    animation: fadeInRight 1s ease-out 0.2s both;
  }

  .feature-points {
    margin-top: 1.5rem;
  }

  .feature-point {
    margin-bottom: 0.5rem;
    animation: fadeInUp 0.5s ease-out both;

    &:nth-child(1) { animation-delay: 0.4s; }
    &:nth-child(2) { animation-delay: 0.5s; }
    &:nth-child(3) { animation-delay: 0.6s; }
  }

  @keyframes fadeInLeft {
    from {
      opacity: 0;
      transform: translateX(-40px);
    }
    to {
      opacity: 1;
      transform: translateX(0);
    }
  }

  @keyframes fadeInRight {
    from {
      opacity: 0;
      transform: translateX(40px);
    }
    to {
      opacity: 1;
      transform: translateX(0);
    }
  }

  @keyframes fadeInUp {
    from {
      opacity: 0;
      transform: translateY(20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .feature-image-wrapper {
    display: flex;
    justify-content: center;
    align-items: center;
    perspective: 1000px;
  }

  .showcase_image {
    border-radius: 1rem;
    max-width: 100%;
    height: auto;
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15);
    transition: box-shadow 0.3s ease;
    will-change: transform;

    &:hover {
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.2);
    }
  }

  // Mobile-specific ordering
  @media screen and (max-width: 768px) {
    .order-1-mobile {
      order: 1;
    }

    .order-2-mobile {
      order: 2;
    }

    .feature {
      margin-bottom: 3rem;
    }
  }
</style>
